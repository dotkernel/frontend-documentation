<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="description" content="Dotkernel Frontend">
        
        

        
        
            
        
        <meta name="docsearch:version" content="5.0.0,latest">
        <meta name="docsearch:language" content="en">
        <meta name="docsearch:component" content="frontend">

        
        <link rel="canonical" href="https://docs.dotkernel.org/frontend-documentation/v5/how-to/csrf/">
        
        <link rel="shortcut icon" href="https://docs.dotkernel.org/img/dk_docs_favicon_white.svg">

        <title>Set Up CSRF - frontend - DotKernel Documentation</title>

        <link rel="stylesheet" href="https://docs.dotkernel.org/css/bootstrap.css">
        <link rel="stylesheet" href="https://docs.dotkernel.org/css/bootstrap-icons.min.css">
        <link rel="stylesheet" href="https://docs.dotkernel.org/css/docs.css">
        <script src="https://docs.dotkernel.org//js/bootstrap.js" defer></script>
        <script src="https://docs.dotkernel.org//js/docs.js" defer></script>
        <script src="https://docs.dotkernel.org//js/scripts.js" defer></script>
    </head>
    <body data-bs-spy="scroll" data-bs-target=".toc" data-bs-offset="100">

        
        <nav class="navbar navbar-expand-lg bg-body-tertiary bg-light dk-nav py-3" data-bs-theme="light">
    <div class="container justify-content-between">
        <div class="dk-nav-icon d-flex align-items-center">
            <a class="navbar-brand" href="https://docs.dotkernel.org/">
                <img alt="DotKernel Logo" class="d-inline-block align-text-top" height="50"
                     src="https://docs.dotkernel.org//img/dk_logomark_white.svg" width="45"/>
            </a>

            <div class="dk-nav-icon-items">
                <span style="font-size: 12px; line-height: 13px">DotKernel Documentation</span>

                <div class="dropdown" data-bs-theme="light">
                    <span class="fw-bold dropdown-toggle dk-pkg-name" data-bs-toggle="dropdown" aria-expanded="false">Frontend</span>
                    <ul class="dropdown-menu">
                        
                        <li class="dropdown-item ">
                            <a href="https://docs.dotkernel.org/api-documentation/" class="nav-link d-flex gap-4 align-items-center">
                                <img alt="DotKernel Logo" class="d-inline-block align-text-top" height="50" src="https://docs.dotkernel.org/img/dk_logomark.svg" width="45" />
                                <div>
                                    <span class="fw-bold d-block">API</span>
                                    <span>DotKernel API</span>
                                </div>
                            </a>
                        </li>
                        
                        <li class="dropdown-item ">
                            <a href="https://docs.dotkernel.org/admin-documentation/" class="nav-link d-flex gap-4 align-items-center">
                                <img alt="DotKernel Logo" class="d-inline-block align-text-top" height="50" src="https://docs.dotkernel.org/img/dk_logomark.svg" width="45" />
                                <div>
                                    <span class="fw-bold d-block">Admin</span>
                                    <span>DotKernel Admin application</span>
                                </div>
                            </a>
                        </li>
                        
                        <li class="dropdown-item bg-light">
                            <a href="https://docs.dotkernel.org/frontend-documentation/" class="nav-link d-flex gap-4 align-items-center">
                                <img alt="DotKernel Logo" class="d-inline-block align-text-top" height="50" src="https://docs.dotkernel.org/img/dk_logomark.svg" width="45" />
                                <div>
                                    <span class="fw-bold d-block">Frontend</span>
                                    <span>DotKernel Frontend application</span>
                                </div>
                            </a>
                        </li>
                        
                        <li class="dropdown-item ">
                            <a href="https://docs.dotkernel.org/light-documentation/" class="nav-link d-flex gap-4 align-items-center">
                                <img alt="DotKernel Logo" class="d-inline-block align-text-top" height="50" src="https://docs.dotkernel.org/img/dk_logomark.svg" width="45" />
                                <div>
                                    <span class="fw-bold d-block">Light</span>
                                    <span>DotKernel Light application</span>
                                </div>
                            </a>
                        </li>
                        
                        <li class="dropdown-item ">
                            <a href="https://docs.dotkernel.org/packages/" class="nav-link d-flex gap-4 align-items-center">
                                <img alt="DotKernel Logo" class="d-inline-block align-text-top" height="50" src="https://docs.dotkernel.org/img/dk_logomark.svg" width="45" />
                                <div>
                                    <span class="fw-bold d-block">Packages</span>
                                    <span>DotKernel packages</span>
                                </div>
                            </a>
                        </li>
                        
                        <li class="dropdown-item ">
                            <a href="https://docs.dotkernel.org/development/" class="nav-link d-flex gap-4 align-items-center">
                                <img alt="DotKernel Logo" class="d-inline-block align-text-top" height="50" src="https://docs.dotkernel.org/img/dk_logomark.svg" width="45" />
                                <div>
                                    <span class="fw-bold d-block">Development</span>
                                    <span>WSL2 Development Environment</span>
                                </div>
                            </a>
                        </li>
                        
                    </ul>
                </div>
            </div>
        </div>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarText">
            <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
<!--                <li class="nav-item">-->
<!--                    <a href="#" class="nav-link fw-bold text-white" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal" title="Open search">-->
<!--                        <i class="bi bi-search"></i> Search-->
<!--                    </a>-->
<!--                </li>-->
                <li class="nav-item">
                    <a class="nav-link fw-bold text-white" href="https://github.com/dotkernel/frontend" title="Go to frontend repository" target="_blank">
                        <i class="bi bi-github"></i>
                        GitHub
                    </a>
                </li>
                <li class="nav-item">
                    
                </li>
            </ul>
        </div>
    </div>
</nav>

        
        <div class="container">
    <nav aria-label="breadcrumb" class="nav_breadcrumb">
        <ol class="breadcrumb">
            
                <li class="breadcrumb-item"><a href="https://docs.dotkernel.org/">Overview</a></li>
                

                
                    <li class="breadcrumb-item"><a href="../../..">frontend</a></li>

                    
                        
                            
                            
                        
                    
                        
                            
                            
                                <li class="breadcrumb-item">How to</li>
                            
                        
                    

                    <li class="breadcrumb-item active" aria-current="page">Set Up CSRF</li>
                
            
        </ol>
    </nav>
</div>

        
        <div class="container">
            <div class="row">
                <div class="col-lg-3 right_sidebar">
                    
                    
    <div class="subnavigation hidden-print">
<!--        <h4 class="subnavigation__title">-->
<!--            <a href="../../..">frontend</a>-->
<!--        </h4>-->

        <h5 class="subnavigation__title">Table of Contents</h5>

        <ul class="subnavigation__list">
            

                
                
                    
                        
<li class="subnavigation__list-item ">
    <a href="../../introduction/introduction/" class="subnavigation__link">Introduction</a>
</li>

                    
                        



















<li class="subnavigation__list-item">
    <a data-bs-toggle="collapse" href="#overview" role="button" aria-expanded="false" aria-controls="overview">
        <span class="subnavigation__headline">Overview</span>
    </a>
    <ul class="subnavigation__list collapse" id="overview">
        
        
<li class="subnavigation__list-item ">
    <a href="../../introduction/server-requirements/" class="subnavigation__link">Server Requirements</a>
</li>

        
        
<li class="subnavigation__list-item ">
    <a href="../../introduction/file-structure/" class="subnavigation__link">File Structure</a>
</li>

        
        
<li class="subnavigation__list-item ">
    <a href="../../introduction/packages/" class="subnavigation__link">Packages</a>
</li>

        
    </ul>
</li>

                    
                        



























<li class="subnavigation__list-item">
    <a data-bs-toggle="collapse" href="#installation" role="button" aria-expanded="false" aria-controls="installation">
        <span class="subnavigation__headline">Installation</span>
    </a>
    <ul class="subnavigation__list collapse" id="installation">
        
        
<li class="subnavigation__list-item ">
    <a href="../../installation/installation-intro/" class="subnavigation__link">Introduction</a>
</li>

        
        
<li class="subnavigation__list-item ">
    <a href="../../installation/getting-started/" class="subnavigation__link">Getting Started</a>
</li>

        
        
<li class="subnavigation__list-item ">
    <a href="../../installation/composer/" class="subnavigation__link">Composer</a>
</li>

        
        
<li class="subnavigation__list-item ">
    <a href="../../installation/configuration-files/" class="subnavigation__link">Configuration Files</a>
</li>

        
        
<li class="subnavigation__list-item ">
    <a href="../../installation/doctrine-orm/" class="subnavigation__link">Doctrine ORM</a>
</li>

        
        
<li class="subnavigation__list-item ">
    <a href="../../installation/development-mode/" class="subnavigation__link">Development Mode</a>
</li>

        
        
<li class="subnavigation__list-item ">
    <a href="../../installation/running-application/" class="subnavigation__link">Running the Application</a>
</li>

        
        
<li class="subnavigation__list-item ">
    <a href="../../installation/faq/" class="subnavigation__link">FAQ</a>
</li>

        
    </ul>
</li>

                    
                        















<li class="subnavigation__list-item">
    <a data-bs-toggle="collapse" href="#how-to" role="button" aria-expanded="false" aria-controls="how-to">
        <span class="subnavigation__headline">How to</span>
    </a>
    <ul class="subnavigation__list collapse" id="how-to">
        
        
<li class="subnavigation__list-item ">
    <a href="../creating-migrations/" class="subnavigation__link">Create Database Migrations</a>
</li>

        
        
<li class="subnavigation__list-item ">
    <a href="../creating-fixtures/" class="subnavigation__link">Create Database Fixtures</a>
</li>

        
        
<li class="subnavigation__list-item ">
    <a href="../authorization/" class="subnavigation__link">Configure Authorizations</a>
</li>

        
        
<li class="subnavigation__list-item ">
    <a href="../npm_commands/" class="subnavigation__link">Use NPM Commands</a>
</li>

        
        
<li class="subnavigation__list-item ">
    <a href="../dependency-injection/" class="subnavigation__link">Inject Dependencies</a>
</li>

        
        
<li class="subnavigation__list-item subnavigation__list-item--active">
    <a href="./" class="subnavigation__link">Set Up CSRF</a>
</li>

        
    </ul>
</li>

                    
                        





















<li class="subnavigation__list-item">
    <a data-bs-toggle="collapse" href="#reference" role="button" aria-expanded="false" aria-controls="reference">
        <span class="subnavigation__headline">Reference</span>
    </a>
    <ul class="subnavigation__list collapse" id="reference">
        
        
<li class="subnavigation__list-item ">
    <a href="../../reference/account-anonymization/" class="subnavigation__link">Anonymize Accounts</a>
</li>

        
    </ul>
</li>

                    
                
            
        </ul>
    </div>

                    

                    
                    
                    
    

    
    
        <div class="toc">
            <h6 class="toc__headline">On this page</h6>
            <ul class="toc__list">
            
                <li class="toc__entry">
                    <a href="#implement-csrf-protection" class="toc__link nav-link">Implement CSRF protection</a>
                </li>
            
                <li class="toc__entry">
                    <a href="#test-the-implementation" class="toc__link nav-link">Test the implementation</a>
                </li>
            
            </ul>
        </div>
    

                    
                </div>
                <div class="col-lg-9 main_docs">
                    
                    




    
    
<!--        <h2 class="chapter__headline text-black-50">How to</h2>-->
    

    <h1 id="csrf-protection-in-forms">CSRF protection in forms</h1>
<p>A Cross-Site Request Forgery (CSRF) attack is a type of security vulnerability that tricks a user into performing actions on a web application in which they are authenticated, without their knowledge or consent.</p>
<p>Web applications can protect users against these types of attacks by implementing CSRF tokens in their forms which are known only to the application that generated them and must be included when submitting forms.
With each visit, a new CSRF token is added to the form so tokens are not reusable between forms.
Failing to provide a valid CSRF token will result in a form validation error.</p>
<h2 id="implement-csrf-protection">Implement CSRF protection</h2>
<p>Implementing CSRF protection requires three steps:</p>
<ul>
<li>create new field using <a href="https://github.com/laminas/laminas-form">laminas/laminas-form</a>'s <a href="https://github.com/laminas/laminas-form/blob/3.21.x/src/Element/Csrf.php">CSRF</a> element</li>
<li>validate new field using <a href="https://github.com/laminas/laminas-session">laminas/laminas-session</a>'s
<a href="https://github.com/laminas/laminas-session/blob/2.22.x/src/Validator/Csrf.php">CSRF</a> validator</li>
<li>render field using <a href="https://github.com/laminas/laminas-form">laminas/laminas-form</a>'s <a href="https://github.com/laminas/laminas-form/blob/3.21.x/src/View/Helper/FormElement.php">FormElement</a> helper</li>
</ul>
<h3 id="create-field">Create field</h3>
<p>Open the form's PHP class and append the following code to the method that initializes the fields (usually <code>init</code>):</p>
<pre class="highlight"><code class="language-php">$this-&gt;add(new \Laminas\Form\Element\Csrf('exampleCsrf', [
    'csrf_options' =&gt; [
        'timeout' =&gt; 3600,
        'session' =&gt; new \Laminas\Session\Container(),
    ],
]));</code></pre>
<blockquote>
<p>You should use a relevant name instead of <code>exampleCsrf</code> that best describes the purpose of the field (example: <code>forgotPasswordCsrf</code>).</p>
</blockquote>
<h3 id="validate-field">Validate field</h3>
<p>Open the InputFilter that validates the form fields and append the following code to the method that initializes the
fields (usually <code>init</code>):</p>
<pre class="highlight"><code class="language-php">$csrf = new \Laminas\InputFilter\Input('exampleCsrf');
$csrf-&gt;setRequired(true);
$csrf-&gt;getFilterChain()
    -&gt;attachByName(\Laminas\Filter\StringTrim::class)
    -&gt;attachByName(\Laminas\Filter\StripTags::class);
$csrf-&gt;getValidatorChain()
    -&gt;attachByName(\Laminas\Validator\NotEmpty::class, [
        'message' =&gt; '&lt;b&gt;CSRF&lt;/b&gt; is required and cannot be empty',
    ], true)
    -&gt;attachByName(\Laminas\Session\Validator\Csrf::class, [
        'name'    =&gt; 'exampleCsrf',
        'message' =&gt; '&lt;b&gt;CSRF&lt;/b&gt; is invalid',
        'session' =&gt; new \Laminas\Session\Container(),
    ], true);
$this-&gt;add($csrf);</code></pre>
<p>Replace <code>exampleCsrf</code> with the CSRF field's name in the form.</p>
<blockquote>
<p>Don't forget to modify both occurrences in this file.</p>
<p>Make sure that you validate the form using its <code>isValid</code> method in the handler/controller where it is submitted.</p>
</blockquote>
<h3 id="render-field">Render field</h3>
<p>Open the template that renders your form and add the following code somewhere between the form's opening and closing tags:</p>
<pre class="highlight"><code class="language-text">{{ formElement(form.get('exampleCsrf')) }}</code></pre>
<h2 id="test-the-implementation">Test the implementation</h2>
<p>Access your form from the browser and view its source.
You should see a new hidden field, called <code>exampleCsrf</code> (or whatever name you used).
After filling out the form, submitting it should work as before.</p>
<p>In order to make sure that the new CSRF field works as expected, you can inspect the form using your browser's <code>Developer tools</code> and modify its value.
Submitting a filled out form should result in a validation error:</p>
<pre class="highlight"><code class="language-text">CSRF is required and cannot be empty</code></pre>
<h3 id="timeout">Timeout</h3>
<p>Note the <code>timeout</code> option in your PHP form's <code>exampleCsrf</code> field, with its default value set to <strong>3600</strong>.
This represents the value in seconds for how long the token is valid.
Submitting a form that has been rendered for longer than this value will result in a validation error:</p>
<pre class="highlight"><code class="language-text">**CSRF** is invalid</code></pre>
<blockquote>
<p>You can modify the value of <code>timeout</code> in each form, but the default value should work in most cases.</p>
</blockquote>




    <nav>
    <ul class="page-nav hidden-print">
        
        <li class="page-nav__item">
            
                <a rel="prev" class="page-nav__link page-nav__link--prev" href="../dependency-injection/">
                    <i class="bi bi-chevron-left"></i>
                    Inject Dependencies
                </a>
            
        </li>

        
        <li class="page-nav__item">
            
                <a rel="next" class="page-nav__link page-nav__link--next" href="../../reference/account-anonymization/">
                    Anonymize Accounts
                    <i class="bi bi-chevron-right"></i>
                </a>
            
        </li>
    </ul>
</nav>



                    
                </div>
            </div>
        </div>

        
        <footer class="footer">
    <div class="container">
        <hr class="mb-5" />

        <div class="row">
            <div class="col-md-9">
                <div class="row">
                    <div class="col-lg-4 col-md-6 dk_widget">
                        <p class="ms-0">API</p>

                        <a href="https://docs.dotkernel.org/api-documentation/">
                            <i class="bi bi-arrow-return-right"></i>
                            Dotkernel web starter project suitable for building RESTful APIs
                        </a>
                    </div>

                    <div class="col-lg-4 col-md-6 dk_widget">
                        <p class="ms-0">Admin</p>

                        <a href="https://docs.dotkernel.org/admin-documentation/">
                            <i class="bi bi-arrow-return-right"></i>
                            Dotkernel web starter project suitable for admin applications
                        </a>
                    </div>

                    <div class="col-lg-4 col-md-6 dk_widget">
                        <p class="ms-0">Frontend</p>

                        <a href="https://docs.dotkernel.org/frontend-documentation/">
                            <i class="bi bi-arrow-return-right"></i>
                            Dotkernel web starter project suitable for frontend applications
                        </a>
                    </div>

                    <div class="col-lg-4 col-md-6 dk_widget">
                        <p class="ms-0">Light</p>

                        <a href="https://docs.dotkernel.org/light-documentation/">
                            <i class="bi bi-arrow-return-right"></i>
                            Dotkernel web starter project suitable for generating a simple website
                        </a>
                    </div>

                    <div class="col-lg-4 col-md-6 dk_widget">
                        <p class="ms-0">Dotkernel Packages</p>

                        <a href="https://docs.dotkernel.org/packages/">
                            <i class="bi bi-arrow-return-right"></i>
                            Dotkernel packages offering a wide range of tools
                        </a>
                    </div>

                    <div class="col-lg-4 col-md-6 dk_widget">
                        <p class="ms-0">Development environment</p>

                        <a href="https://docs.dotkernel.org/development/">
                            <i class="bi bi-arrow-return-right"></i>
                            Install PHP, Apache, MariaDB, Composer, PhpMyAdmin, Node.js and Git on WSL2
                        </a>
                    </div>
                </div>
            </div>

            <div class="col-md-3 pt-3">
                <div class="footer_head">
                    <p>Support</p>
                </div>

                <ul class="support__list row">
                    <li class="support__list-item col-lg-6 mb-md-3">
                        <a href="https://github.com/dotkernel" class="support__link" title="GitHub" target="_blank">
                            <i class="bi bi-github"></i> GitHub
                        </a>
                    </li>
                    <li class="support__list-item col-lg-6 mb-md-3">
                        <a href="https://dotkernel.slack.com" class="support__link" title="Chat" target="_blank">
                            <i class="bi bi-slack"></i> Slack
                        </a>
                    </li>
                    <li class="support__list-item col-lg-6 mb-md-3">
                        <a href="https://twitter.com/dotkernel" class="support__link" title="X (Twitter)" target="_blank">
                            <i class="bi bi-twitter-x"></i> Twitter
                        </a>
                    </li>
                    <li class="support__list-item col-lg-6 mb-md-3">
                        <a href="https://www.dotkernel.com/blog/" class="support__link" title="Blog" target="_blank">
                            <i class="bi bi-file-post"></i> Blog
                        </a>
                    </li>
                    <li class="support__list-item col-lg-6 mb-md-3">
                        <a href="https://www.dotkernel.com/feed/" class="support__link" title="Blog feed" target="_blank">
                            <i class="bi bi-rss-fill"></i> Feed
                        </a>
                    </li>
                </ul>
            </div>
        </div>

        <hr class="mt-5" />

        <div class="footer_copy">
            &#169; Copyright Dotkernel 2024. All rights reserved.
        </div>
    </div>
</footer>

        <script>
            let base_url = '../../..',
                project  = "frontend",
                siteName = 'frontend';

                document.addEventListener("DOMContentLoaded", function() {
                    document.querySelectorAll('.subnavigation__link').forEach(function(link) {
                        if (link.getAttribute('href') === './') {
                            link.parentNode.parentNode.classList.add('show');
                        }
                    });
                });
        </script>
<!--        -->
<!--        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Search</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search in frontend" id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
        </div>
    </div>
</div>-->
    </body>
</html>
